<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8K Stock Market Candlestick Chart with Cluster Analysis</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìà 8K Stock Market Candlestick Analysis</h1>
            <div class="subtitle">Interactive Hourly Data with ML Cluster Classification</div>
        </div>

        <div class="data-input">
            <h3>üìä Data Input</h3>
            <p>Paste your CSV data below (with headers: timestamp,open,high,low,close,volume,predicted_cluster) or use sample data:</p>
            <textarea id="csvInput" placeholder="timestamp,open,high,low,close,volume,predicted_cluster
2024-09-06T09:00:00Z,520.50,525.00,519.00,523.75,1250000,0
2024-09-06T10:00:00Z,523.75,526.50,521.00,524.25,980000,1
..."></textarea>
            <div class="data-buttons">
                <button class="btn btn-primary" onclick="loadCSVData()">üìà Load CSV Data</button>
                <button class="btn btn-secondary" onclick="generateSampleData()">üé≤ Generate Sample Data</button>
                <button class="btn btn-secondary" onclick="clearData()">üóëÔ∏è Clear</button>
            </div>
            <div id="dataStatus"></div>
        </div>
        
        <div class="controls">
            <!-- Chart Configuration Section -->
            <div class="control-section">
                <h3>üìä Chart Configuration</h3>
            <div class="control-group">
                <label for="chartType">Chart Type:</label>
                <select id="chartType" onchange="updateChart()">
                    <option value="candlestick">Standard Candlestick</option>
                    <option value="scatter">Scatter Plot</option>
                    <option value="line">Line Chart</option>
                    <option value="histogram">Histogram</option>
                </select>
            </div>
            
            
            <div class="control-group" id="candleWidthGroup">
                <label for="candleWidth">Candle Width:</label>
                <input type="range" id="candleWidth" min="2" max="20" value="8" onchange="updateChart()">
            </div>
            
                <div class="control-group">
                    <label for="showVolume">Show Volume:</label>
                    <select id="showVolume" onchange="updateChart()">
                        <option value="true">Yes</option>
                        <option value="false">No</option>
                    </select>
                </div>
            </div>
            
            <!-- Axis Configuration Section -->
            <div class="control-section">
                <h3>üìà Axis Configuration</h3>
            <div class="control-group" id="xAxisGroup" style="display: none;">
                <label for="xAxis">X-Axis Feature:</label>
                <select id="xAxis" onchange="updateChart()">
                    <option value="timestamp">Timestamp</option>
                    <option value="open">Open Price</option>
                    <option value="high">High Price</option>
                    <option value="low">Low Price</option>
                    <option value="close">Close Price</option>
                    <option value="volume">Volume</option>
                </select>
            </div>
            
            <div class="control-group" id="yAxisGroup" style="display: none;">
                <label for="yAxis">Y-Axis Feature:</label>
                <select id="yAxis" onchange="updateChart()">
                    <option value="close">Close Price</option>
                    <option value="open">Open Price</option>
                    <option value="high">High Price</option>
                    <option value="low">Low Price</option>
                    <option value="volume">Volume</option>
                </select>
            </div>
            
            <div class="control-group" id="histogramGroup" style="display: none;">
                <label for="histogramFeature">Histogram Feature:</label>
                <select id="histogramFeature" onchange="updateChart()">
                    <option value="close">Close Price</option>
                    <option value="open">Open Price</option>
                    <option value="high">High Price</option>
                    <option value="low">Low Price</option>
                    <option value="volume">Volume</option>
                </select>
            </div>
            </div>
            
            <!-- Filtering Section -->
            <div class="control-section">
                <h3>üîç Data Filtering</h3>
            <div class="control-group">
                <label for="clusterFilter">Filter by Cluster:</label>
                <select id="clusterFilter" onchange="updateChart()">
                    <option value="all">All Clusters</option>
                    <option value="0">Cluster 0</option>
                    <option value="1">Cluster 1</option>
                    <option value="2">Cluster 2</option>
                    <option value="3">Cluster 3</option>
                    <option value="4">Cluster 4</option>
                    <option value="5">Cluster 5</option>
                    <option value="6">Cluster 6</option>
                    <option value="7">Cluster 7</option>
                </select>
            </div>
                
                <div class="control-group">
                    <label for="candleTypeFilter">Filter by Candle Type:</label>
                    <select id="candleTypeFilter" onchange="updateChart()">
                        <option value="all">All Candles</option>
                        <option value="bullish">Bullish (Green)</option>
                        <option value="bearish">Bearish (Red)</option>
                    </select>
        </div>
        
            </div>
            
            <!-- Visual Styling Section -->
            <div class="control-section">
                <h3>üé® Visual Styling</h3>
                <div class="checkbox-group">
                    <input type="checkbox" id="showClusterColors" checked onchange="updateChart()">
                    <label for="showClusterColors">Show Cluster Colors</label>
                </div>
                
            </div>
        </div>
        
        <div class="legend">
            <h3>üìä Chart Legend</h3>
            <div class="legend-content" id="legend"></div>
        </div>
        
        <div class="stats">
            <h3>üìà Statistics</h3>
            <div class="stats-content" id="stats"></div>
        </div>
        
        
        <div class="chart-container">
            <canvas id="candlestickChart"></canvas>
            
            <!-- Chart Overlay -->
            <div class="chart-overlay">
                <!-- Settings Buttons (Top Right) -->
                <div class="overlay-top-right">
                    <div class="overlay-settings" onclick="toggleSettings()">‚öôÔ∏è Settings</div>
                    <div class="overlay-settings" onclick="resetChartToDefault()" style="margin-left: 10px;">üîÑ Reset</div>
                    <div class="overlay-settings" onclick="toggleFullscreen()" style="margin-left: 10px;">‚õ∂ Fullscreen</div>
                </div>
                
                <!-- Settings Panel (Inside Chart) -->
                <div class="overlay-settings-panel hidden" id="overlaySettingsPanel">
                    <div class="overlay-settings-group">
                        <label>Panel Opacity</label>
                        <input type="range" id="panelOpacity" min="0.3" max="1" step="0.1" value="0.8" onchange="updatePanelOpacity()">
                        <div class="overlay-settings-value" id="opacityValue">80%</div>
                    </div>
                    
                    <div class="overlay-settings-group">
                        <label>Show Panels</label>
                        <div class="overlay-settings-checkbox">
                            <input type="checkbox" id="showChartPanel" checked onchange="updatePanelVisibility()">
                            <label for="showChartPanel">Chart</label>
                        </div>
                        <div class="overlay-settings-checkbox">
                            <input type="checkbox" id="showFiltersPanel" checked onchange="updatePanelVisibility()">
                            <label for="showFiltersPanel">Filters</label>
                        </div>
                        <div class="overlay-settings-checkbox">
                            <input type="checkbox" id="showColorsPanel" checked onchange="updatePanelVisibility()">
                            <label for="showColorsPanel">Colors</label>
                        </div>
                        <div class="overlay-settings-checkbox">
                            <input type="checkbox" id="showStatsPanel" checked onchange="updatePanelVisibility()">
                            <label for="showStatsPanel">Stats</label>
                        </div>
                        <div class="overlay-settings-checkbox">
                            <input type="checkbox" id="showLegendPanel" checked onchange="updatePanelVisibility()">
                            <label for="showLegendPanel">Legend</label>
                        </div>
                    </div>
                    
                    <div class="overlay-settings-group">
                        <label>Max Visible Points</label>
                        <input type="range" id="maxVisiblePoints" min="10" max="200" value="50" onchange="updateMaxVisiblePoints()">
                        <div class="overlay-settings-value" id="maxVisiblePointsValue">50</div>
                    </div>
                    
                    <div class="overlay-settings-group">
                        <label>Panning Sensitivity</label>
                        <input type="range" id="panningSensitivity" min="0.1" max="5" step="0.1" value="1.0" onchange="updatePanningSensitivity()">
                        <div class="overlay-settings-value" id="panningSensitivityValue">1.0</div>
                    </div>
                    
                    <div class="overlay-settings-group">
                        <label>Number of Rows</label>
                        <input type="number" id="numRows" min="10" max="1000" value="200" onchange="handleNumRowsChange()" style="width: 100%; padding: 4px; border: 1px solid #333; background: rgba(0,0,0,0.5); color: white; border-radius: 3px;">
                    </div>
                    
                    <div class="overlay-settings-group">
                        <label style="font-weight: 600; color: #00ff88; margin-bottom: 8px;">Keyboard Shortcuts</label>
                        <div style="font-size: 11px; line-height: 1.4; color: #ccc;">
                            <div>Arrow Keys: Pan through data</div>
                            <div>Home: Go to latest data</div>
                            <div>End: Go to earliest data</div>
                            <div>Ctrl/Shift+Mouse wheel: Adjust visible points</div>
                            <div>Page Up/Down: Adjust visible points</div>
                            <div>Drag left/right: Pan through time</div>
                            <div>+/-: Increase/decrease panning sensitivity</div>
                            <div>R: Reset chart to default</div>
                            <div>C: Toggle crosshair on/off</div>
                            <div>S: Toggle crosshair snap to candles</div>
                            <div>F: Toggle fullscreen mode</div>
                            <div>ESC: Exit fullscreen mode</div>
                        </div>
                    </div>
                    
                    <div class="overlay-settings-group">
                        <button class="overlay-panel-btn" onclick="debugChart()" style="width: 100%; padding: 8px; font-size: 12px;">
                            üêõ Debug Chart
                        </button>
                    </div>
                    
                    <div class="overlay-settings-group">
                        <label style="font-weight: 600; color: #00ff88; margin-bottom: 8px;">Settings Management</label>
                        <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                            <button class="overlay-panel-btn" onclick="saveSettingsWithNotification()" style="flex: 1; padding: 6px; font-size: 11px;">
                                üíæ Save
                            </button>
                            <button class="overlay-panel-btn" onclick="loadSettings()" style="flex: 1; padding: 6px; font-size: 11px;">
                                üìÇ Load
                            </button>
                            <button class="overlay-panel-btn" onclick="clearSettings()" style="flex: 1; padding: 6px; font-size: 11px;">
                                üóëÔ∏è Clear
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- All Panels on Left Side -->
                <div class="overlay-left" id="overlayLeft">
                    <!-- Chart Configuration Panel -->
                    <div class="overlay-panel" id="chartPanel">
                        <div class="overlay-panel-header" onclick="togglePanel('chartPanel')">
                            <h4>üìä Chart</h4>
                            <div class="overlay-panel-controls">
                                <button class="overlay-panel-btn minimize-btn" onclick="event.stopPropagation(); togglePanel('chartPanel')">‚àí</button>
                            </div>
                        </div>
                        <div class="overlay-controls">
                            <div class="overlay-control-group">
                                <label>Type</label>
                                <select id="overlayChartType" onchange="updateChart()">
                                    <option value="candlestick">Candlestick</option>
                                    <option value="scatter">Scatter</option>
                                    <option value="line">Line</option>
                                    <option value="histogram">Histogram</option>
                                </select>
                            </div>
                            <div class="overlay-control-group" id="overlayCandleWidthGroup">
                                <label>Width</label>
                                <input type="range" id="overlayCandleWidth" min="2" max="20" value="8" onchange="updateChart()">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Filters Panel -->
                    <div class="overlay-panel" id="filtersPanel">
                        <div class="overlay-panel-header" onclick="togglePanel('filtersPanel')">
                            <h4>üîç Filters</h4>
                            <div class="overlay-panel-controls">
                                <button class="overlay-panel-btn minimize-btn" onclick="event.stopPropagation(); togglePanel('filtersPanel')">‚àí</button>
                            </div>
                        </div>
                        <div class="overlay-controls">
                            <div class="overlay-control-group">
                                <label>Cluster</label>
                                <select id="overlayClusterFilter" onchange="updateChart()">
                                    <option value="all">All</option>
                                    <option value="0">Cluster 0</option>
                                    <option value="1">Cluster 1</option>
                                    <option value="2">Cluster 2</option>
                                    <option value="3">Cluster 3</option>
                                    <option value="4">Cluster 4</option>
                                    <option value="5">Cluster 5</option>
                                    <option value="6">Cluster 6</option>
                                    <option value="7">Cluster 7</option>
                                </select>
                            </div>
                            <div class="overlay-control-group">
                                <label>Candle Type</label>
                                <select id="overlayCandleTypeFilter" onchange="updateChart()">
                                    <option value="all">All</option>
                                    <option value="bullish">Bullish</option>
                                    <option value="bearish">Bearish</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Colors Panel -->
                    <div class="overlay-panel" id="colorsPanel">
                        <div class="overlay-panel-header" onclick="togglePanel('colorsPanel')">
                            <h4>üé® Colors</h4>
                            <div class="overlay-panel-controls">
                                <button class="overlay-panel-btn minimize-btn" onclick="event.stopPropagation(); togglePanel('colorsPanel')">‚àí</button>
                            </div>
                        </div>
                        <div class="overlay-controls">
                            <div class="overlay-control-group">
                                <label>
                                    <input type="checkbox" id="overlayShowClusterColors" checked onchange="updateChart()" style="margin-right: 6px;">
                                    Cluster Colors
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Statistics Panel -->
                    <div class="overlay-panel" id="statsPanel">
                        <div class="overlay-panel-header" onclick="togglePanel('statsPanel')">
                            <h4>üìà Stats</h4>
                            <div class="overlay-panel-controls">
                                <button class="overlay-panel-btn minimize-btn" onclick="event.stopPropagation(); togglePanel('statsPanel')">‚àí</button>
                            </div>
                        </div>
                        <div class="overlay-stats" id="overlayStats">
                            <!-- Stats will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Legend Panel -->
                    <div class="overlay-panel" id="legendPanel">
                        <div class="overlay-panel-header" onclick="togglePanel('legendPanel')">
                            <h4>üìä Legend</h4>
                            <div class="overlay-panel-controls">
                                <button class="overlay-panel-btn minimize-btn" onclick="event.stopPropagation(); togglePanel('legendPanel')">‚àí</button>
                            </div>
                        </div>
                        <div class="overlay-legend" id="overlayLegend">
                            <!-- Legend will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="dashboard.js"></script>
</body>
</html>